<html>
	<head>
		
		<script src="http://d3js.org/d3.v3.min.js"></script>
		<script src="http://d3js.org/topojson.v1.min.js"></script>

		<script>
			d3.json('ltu.json', function(error, ltu) {
				if (error) return console.error(error);
				console.log(ltu);

				var width = 800;
				var height = 500;

				var svg = d3.select('body').append('svg') 
					.attr('width', width)
					.attr('height', height);

				var projection = d3.geo.mercator()
					.scale(1)
					.translate([0, 0]);

				var path = d3.geo.path()
					.projection(projection);

				var bounds = path.bounds(ltu);
				var scale = .95 / Math.max(
					(bounds[1][0] - bounds[0][0]) / width,
					(bounds[1][1] - bounds[0][1]) / height);
				var translate = [
					(width - scale * (bounds[1][0] + bounds[0][0])) / 2,
					(height - scale * (bounds[1][1] + bounds[0][1])) / 2
				];

				projection
					.scale(scale)
					.translate(translate);

				svg.append('path')
					.datum(ltu)
					.attr('d', path)
					.style({
						fill: '#BBB',
					});

				d3.json('stations.json', function(error, stations) {
					var points = [];
					
					svg.selectAll('path')
						.data(stations.stations)
						.enter().append('circle')
						.attr('r', 4)
						.attr('name', function(d) { return d.name })
						.attr('cx', function(d) { return projection([d.longitude, d.latitude])[0] })
						.attr('cy', function(d) { return projection([d.longitude, d.latitude])[1] })
						.style({
							'fill': '#BBB',
							'stroke': '#fff',
							'stroke-width': 1.5
						})
				})
			});
		</script>
	</head>
	<body>
		
	</body>
</html>